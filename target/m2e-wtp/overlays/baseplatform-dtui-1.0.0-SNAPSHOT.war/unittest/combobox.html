<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<link rel="stylesheet" href="../dtui/theme/dtui.css" type="text/css" />
<link rel="stylesheet" href="./qunit/qunit.css" type="text/css" />
<script src="../dtui/js/jquery/jquery.js"></script>
<script src="../dtui/js/jqueryui/jquery-ui.js"></script>
<script src="./qunit/qunit.js"></script>

<script src="../dtui/js/dtui.util.js" type="text/javascript"></script>
<script type="text/javascript" src="../dtui/js/dtui.combobox.js"></script>
<!-- <link rel="stylesheet" href="../demos.css" /> -->
<script type="text/javascript">
$(function(){
	
	$("#shengfen").dtcombobox({id:'shengfen', label:'省',name:'shengfen',relaId:'city',
		hasNull:true,selectIndex:'-1',width:'80%',keyField:'id',valueField:'name',onChange:function(){
			$("#shengfen").dtcombobox('val','');
		},
		datasource:[{'id':'henan','name':'河南'},{'id':'liaoning','name':'辽宁'}]});

	//setTimeout(window, 1000);
	$("#city").dtcombobox({refreshUrl:'../../ComboboxAction',selectValue:'',
				readyOnly:'true',sourceTargetId:'shengfen',id:'city', paramkey:'id',
				keyField:'id',selectIndex:'-1',hasNull:true,onChange:'',
				name:'city',valueField:'name',hasAll:'true',datasource:''});
	

	var setting = {
			width: '100px',
		name : 'comboxName',
		datasource : [{"id":"henan","name":"河南"},{"id":"liaoning","name":"辽宁"}],
		
		keyField : "id",	
		valueField : "name",
		selectIndex : -1,
		selectValue :  'liaoning',
		hasAll : false,
		allKey : "all",
		allValue : '--全部--',
		hasNull : true,
			
		nullValue : "--请选择--",
		
		relaId : 'city',
		
		
		paramkey : '',
		prompt : '下拉框',
		required : false,
		readonly : false	
	};
	
	$('#testdiv').dtcombobox(setting);		
	
	test('初始属性测试', function(){
		strictEqual('100px', $('#testdiv').dtcombobox('option','width'));
		strictEqual('liaoning', $('#testdiv').dtcombobox('selectValue'));
	});
	test('selectValue方法测试', function(){
		$('#testdiv').dtcombobox('selectValue','henan');
		strictEqual('henan', $('#testdiv').dtcombobox('selectValue'));
		strictEqual('河南', $('#testdiv').dtcombobox('selectText'));
		strictEqual('0', $('#testdiv').dtcombobox('selectIndex'));
		
		$('#testdiv').dtcombobox('selectValue','liaoning');
		strictEqual('liaoning', $('#testdiv').dtcombobox('selectValue'));
		strictEqual('辽宁', $('#testdiv').dtcombobox('selectText'));
		strictEqual('1', $('#testdiv').dtcombobox('selectIndex'));
	});
	test('selectIndex方法测试', function(){
		$('#testdiv').dtcombobox('selectIndex',0);
		strictEqual('henan', $('#testdiv').dtcombobox('selectValue'));
		strictEqual('河南', $('#testdiv').dtcombobox('selectText'));
		strictEqual('0', $('#testdiv').dtcombobox('selectIndex'));
		
		$('#testdiv').dtcombobox('selectIndex',1);
		strictEqual('liaoning', $('#testdiv').dtcombobox('selectValue'));
		strictEqual('辽宁', $('#testdiv').dtcombobox('selectText'));
		strictEqual('1', $('#testdiv').dtcombobox('selectIndex'));
	});
	
	
});
</script> 
</head>
<body >
<div class="a" id="shengfen"></div>
<br/>
<div id="city" ></div>

<br />
<div id="testdiv"></div>

  <div id="qunit"></div>
  <div id="qunit-fixture"></div>


</body>
</html>